!pip install absl-py==0.7.1
!pip install alabaster==0.7.10
!pip install alembic==1.0.9
!pip install algopy==0.5.7
!pip install altair==2.4.1
!pip install anaconda-client==1.6.14
!pip install anaconda-navigator==1.8.7
!pip install anaconda-project==0.8.2
!pip install annoy==1.15.2
!pip install appdirs==1.4.3
!pip install arrow==0.13.1
!pip install asn1crypto==0.24.0
!pip install astor==0.7.1
!pip install astroid==1.6.3
!pip install astropy==3.0.2
!pip install attrs==18.1.0
!pip install audioread==2.1.6
!pip install babel==2.5.3
!pip install backcall==0.1.0
!pip install backports.shutil-get-terminal-size==1.0.0
!pip install baker==1.3
!pip install basemap==1.2.0
!pip install bayesian-optimization==1.0.1
!pip install bayespy==0.5.18
!pip install bcolz==1.2.1
!pip install beautifulsoup4==4.6.0
!pip install biopython==1.73
!pip install bitarray==0.8.1
!pip install bkcharts==0.2
!pip install blaze==0.11.3
!pip install bleach==2.1.3
!pip install blis==0.2.4
!pip install blist==1.3.6
!pip install bokeh==1.1.0
!pip install boruta==0.1.5
!pip install boto3==1.9.134
!pip install boto==2.48.0
!pip install botocore==1.12.134
!pip install bottleneck==1.2.1
!pip install bq-helper==0.4.1
!pip install branca==0.3.1
!pip install brewer2mpl==1.4.1
!pip install bz2file==0.98
!pip install cachetools==3.1.0
!pip install cairocffi==file-.cairocffi-VERSION
!pip install cairosvg==2.3.1
!pip install cartopy==0.17.0
!pip install catboost==0.14.2
!pip install category-encoders==1.3.0
!pip install certifi==2019.3.9
!pip install cesium==0.9.9
!pip install cffi==1.11.5
!pip install chainer==5.4.0
!pip install chainercv==0.12.0
!pip install chardet==3.0.4
!pip install cleverhans==3.0.1
!pip install click-plugins==1.1.1
!pip install click==7.0
!pip install cliff==2.14.1
!pip install cligj==0.5.0
!pip install cloudpickle==0.5.3
!pip install clyent==1.2.2
!pip install cmd2==0.9.12
!pip install cmudict==0.4.2
!pip install colorama==0.3.9
!pip install colorcet==2.0.1
!pip install colorlog==4.0.2
!pip install colorlover==0.3.0
!pip install conda-build==3.10.5
!pip install conda-verify==2.0.0
!pip install conda==4.6.14
!pip install configargparse==0.14.0
!pip install contextlib2==0.5.5
!pip install convertdate==2.1.3
!pip install conx==3.7.7
!pip install coverage==4.5.3
!pip install cryptography==2.2.2
!pip install cssselect2==0.2.1
!pip install cufflinks==0.15
!pip install cvxcanon==0.1.1
!pip install cvxpy==1.0.21
!pip install cycler==0.10.0
!pip install cymem==2.0.2
!pip install cysignals==1.10.2
!pip install cython==0.29.7
!pip install cytoolz==0.9.0.1
!pip install dask-glm==0.2.0
!pip install dask-ml==0.12.0
!pip install dask-xgboost==0.1.5
!pip install dask==1.2.0
!pip install dataclasses==0.6
!pip install datashader==0.7.0
!pip install datashape==0.5.4
!pip install deap==1.2.2
!pip install decorator==4.3.0
!pip install deepdish==0.3.6
!pip install defusedxml==0.6.0
!pip install delorean==1.0.0
!pip install descartes==1.1.0
!pip install dill==0.2.9
!pip install dipy==0.14.0
!pip install distributed==1.27.0
!pip install docopt==0.6.2
!pip install docutils==0.14
!pip install dora==0.1
!pip install ecos==2.0.5
!pip install edward==1.3.5
!pip install eli5==0.8.2
!pip install emoji==0.5.2
!pip install en-core-web-lg==2.1.0
!pip install en-core-web-sm==2.1.0
!pip install entrypoints==0.2.3
!pip install enum34==1.1.6
!pip install ephem==3.7.6.0
!pip install essentia==2.1b5.dev532
!pip install et-xmlfile==1.0.1
!pip install ethnicolr==0.2.0
!pip install fancyimpute==0.4.3
!pip install fastai==1.0.51
!pip install fastcache==1.0.2
!pip install fasteners==0.14.1
!pip install fastfm==0.2.11
!pip install fastprogress==0.1.21
!pip install fasttext==0.8.22
!pip install fbpca==1.0
!pip install fbprophet==0.4.post2
!pip install feather-format==0.4.0
!pip install featuretools==0.7.0
!pip install filelock==3.0.4
!pip install fiona==1.8.6
!pip install fitter==1.0.9
!pip install flake8==3.6.0
!pip install flashtext==2.7
!pip install flask-cors==3.0.4
!pip install flask==1.0.2
!pip install flatbuffers==1.10
!pip install folium==0.8.3
!pip install ftfy==4.4.3
!pip install funcsigs==1.0.2
!pip install funcy==1.12
!pip install future==0.17.1
!pip install fuzzywuzzy==0.17.0
!pip install gast==0.2.2
!pip install gatspy==0.3
!pip install gdbn==0.1
!pip install gensim==3.7.2
!pip install geographiclib==1.49
!pip install geohash==1.0
!pip install geojson==2.4.1
!pip install geopandas==0.4.1
!pip install geoplot==0.2.4
!pip install geopy==1.19.0
!pip install geoviews==1.6.1
!pip install gevent==1.3.0
!pip install ggplot==0.11.5
!pip install glmnet-py==0.1.0b2
!pip install glob2==0.6
!pip install gluoncv==0.4.0.post0
!pip install gluonnlp==0.6.0
!pip install gmpy2==2.0.8
!pip install gnumpy==0.2
!pip install google-api-core==1.9.0
!pip install google-api-python-client==1.7.8
!pip install google-auth-httplib2==0.0.3
!pip install google-auth==1.6.3
!pip install google-cloud-bigquery==1.11.2
!pip install google-cloud-core==0.29.1
!pip install google-resumable-media==0.3.2
!pip install googleapis-common-protos==1.5.9
!pip install gplearn==0.4.0
!pip install gpxpy==1.3.5
!pip install graphviz==0.8.4
!pip install greenlet==0.4.13
!pip install grpcio==1.20.0
!pip install gym==0.12.1
!pip install h2o==3.24.0.2
!pip install h5py==2.9.0
!pip install hallucinate==0.0.1
!pip install haversine==2.0.0
!pip install heamy==0.0.7
!pip install heapdict==1.0.0
!pip install hep-ml==0.6.0
!pip install hmmlearn==0.2.1
!pip install holidays==0.9.10
!pip install holoviews==1.12.1
!pip install hpsklearn==0.1.0
!pip install html5lib==1.0.1
!pip install httplib2==0.12.3
!pip install humanize==0.5.1
!pip install hunspell==0.5.5
!pip install husl==4.0.3
!pip install hyperopt==0.1.2
!pip install hypertools==0.5.1
!pip install hypothesis==4.17.2
!pip install ibis-framework==1.0.0
!pip install idna==2.6
!pip install ijson==2.3
!pip install imagehash==4.0
!pip install imageio==2.3.0
!pip install imagesize==1.0.0
!pip install imbalanced-learn==0.5.0.dev0
!pip install imgaug==0.2.8
!pip install implicit==0.3.8
!pip install ipykernel==4.8.2
!pip install ipython-genutils==0.2.0
!pip install ipython==6.4.0
!pip install ipywidgets==7.2.1
!pip install iso3166==1.0
!pip install isort==4.3.4
!pip install isoweek==1.3.3
!pip install itsdangerous==0.24
!pip install janome==0.3.8
!pip install jdcal==1.4
!pip install jedi==0.12.0
!pip install jieba==0.39
!pip install jinja2==2.10
!pip install jmespath==0.9.4
!pip install joblib==0.13.2
!pip install jsonpickle==0.9.6
!pip install jsonschema==2.6.0
!pip install jupyter-client==5.2.3
!pip install jupyter-console==5.2.0
!pip install jupyter-core==4.4.0
!pip install jupyter-tensorboard==0.1.9
!pip install jupyter==1.0.0
!pip install jupyterlab-launcher==0.10.5
!pip install jupyterlab==0.32.1
!pip install keras-applications==1.0.7
!pip install keras-preprocessing==1.0.9
!pip install keras-rcnn==0.0.2
!pip install keras-resnet==0.1.0
!pip install keras-rl==0.4.2
!pip install keras-tqdm==2.0.1
!pip install keras==2.2.4
!pip install kiwisolver==1.0.1
!pip install kmapper==1.2.0
!pip install kmeans-smote==0.1.2
!pip install kmodes==0.10.1
!pip install knnimpute==0.1.0
!pip install ktext==0.34
!pip install langdetect==1.0.7
!pip install langid==1.1.6
!pip install lasagne==0.2.dev1
!pip install lazy-object-proxy==1.3.1
!pip install learntools==0.2.13
!pip install leven==1.0.4
!pip install librosa==0.6.3
!pip install lightfm==1.15
!pip install lightgbm==2.2.3
!pip install lime==0.1.1.33
!pip install line-profiler==2.1.2
!pip install llvmlite==0.23.1
!pip install lml==0.0.9
!pip install locket==0.2.0
!pip install lunardate==0.2.0
!pip install lxml==4.2.1
!pip install lz4==2.1.2
!pip install mako==1.0.9
!pip install marisa-trie==0.7.5
!pip install markdown==3.1
!pip install markovify==0.7.1
!pip install markupsafe==1.0
!pip install matplotlib-venn==0.11.5
!pip install matplotlib==3.0.3
!pip install mccabe==0.6.1
!pip install memory-profiler==0.55.0
!pip install missingno==0.4.1
!pip install mistune==0.8.3
!pip install mizani==0.5.4
!pip install mkl-fft==1.0.10
!pip install mkl-random==1.0.1
!pip install ml-metrics==0.1.4
!pip install mlcrate==0.2.0
!pip install mlens==0.2.3
!pip install mlxtend==0.16.0.dev0
!pip install mmh3==2.5.1
!pip install mne==0.17.2
!pip install mnist==0.2.2
!pip install mock==2.0.0
!pip install monotonic==1.5
!pip install more-itertools==4.1.0
!pip install mpld3==0.3
!pip install mplleaflet==0.0.5
!pip install mpmath==1.0.0
!pip install msgpack-numpy==0.4.4.2
!pip install msgpack-python==0.5.6
!pip install msgpack==0.6.1
!pip install multipledispatch==0.6.0
!pip install multiprocess==0.70.7
!pip install munch==2.3.2
!pip install murmurhash==1.0.0
!pip install mxnet==1.4.0.post0
!pip install navigator-updater==0.2.1
!pip install nbconvert==5.3.1
!pip install nbformat==4.4.0
!pip install nervananeon==2.6.0
!pip install networkx==2.1
!pip install nibabel==2.4.0
!pip install nilearn==0.5.2
!pip install nltk==3.2.4
!pip install nolearn==0.6.1.dev0
!pip install nose==1.3.7
!pip install notebook==5.5.0
!pip install np-utils==0.5.10.0
!pip install numba==0.38.0
!pip install numdifftools==0.9.20
!pip install numexpr==2.6.5
!pip install numpy==1.16.3
!pip install numpydoc==0.8.0
!pip install nvidia-ml-py3==7.352.0
!pip install odfpy==1.4.0
!pip install odo==0.5.1
!pip install olefile==0.45.1
!pip install onnx==1.4.1
!pip install opencv-python==4.1.0.25
!pip install openpyxl==2.5.3
!pip install optuna==0.10.0
!pip install orderedmultidict==1.0
!pip install ortools==7.0.6546
!pip install osqp==0.5.0
!pip install packaging==17.1
!pip install palettable==3.1.1
!pip install pandas-datareader==0.7.0
!pip install pandas-profiling==1.4.1
!pip install pandas-summary==0.0.6
!pip install pandas==0.23.4
!pip install pandasql==0.7.3
!pip install pandoc==1.0.2
!pip install pandocfilters==1.4.2
!pip install param==1.9.0
!pip install paramnb==2.0.4
!pip install parso==0.2.0
!pip install partd==0.3.8
!pip install path.py==11.0.1
!pip install pathlib2==2.3.2
!pip install pathos==0.2.3
!pip install patsy==0.5.0
!pip install pbr==5.1.3
!pip install pdf2image==1.5.1
!pip install pdpbox==0.2.0
!pip install pep8==1.7.1
!pip install pexpect==4.5.0
!pip install pickleshare==0.7.4
!pip install pillow==5.1.0
!pip install pip==19.0.3
!pip install pkginfo==1.4.2
!pip install plac==0.9.6
!pip install plotly-express==0.1.7
!pip install plotly==3.8.1
!pip install plotnine==0.4.0
!pip install pluggy==0.6.0
!pip install ply==3.11
!pip install polyglot==16.7.4
!pip install posix-ipc==1.0.4
!pip install pox==0.2.5
!pip install ppca==0.0.4
!pip install ppft==1.6.4.9
!pip install preprocessing==0.1.13
!pip install preshed==2.0.1
!pip install prettytable==0.7.2
!pip install progressbar2==3.39.3
!pip install prompt-toolkit==1.0.15
!pip install pronouncing==0.2.0
!pip install protobuf==3.7.1
!pip install psutil==5.6.1
!pip install ptyprocess==0.5.2
!pip install pudb==2018.1
!pip install py-cpuinfo==5.0.0
!pip install py-lz4framed==0.13.0
!pip install py-stringmatching==0.4.1
!pip install py-stringsimjoin==0.3.0
!pip install py==1.5.3
!pip install pyahocorasick==1.4.0
!pip install pyarabic==0.6.5
!pip install pyarrow==0.10.0
!pip install pyasn1-modules==0.2.5
!pip install pyasn1==0.4.5
!pip install pyastronomy==0.13.0
!pip install pybind11==2.2.4
!pip install pybrain==0.3.3
!pip install pycairo==1.18.0
!pip install pycodestyle==2.4.0
!pip install pycosat==0.6.3
!pip install pycountry==18.12.8
!pip install pycparser==2.18
!pip install pycrypto==2.6.1
!pip install pyct==0.4.6
!pip install pycurl==7.43.0.1
!pip install pydash==4.7.4
!pip install pydicom==1.2.2
!pip install pydot==1.4.1
!pip install pyeconometrics==1.0.2
!pip install pyemd==0.5.1
!pip install pyexcel-io==0.5.17
!pip install pyexcel-ods==0.5.6
!pip install pyfasttext==0.4.6
!pip install pyflakes==2.0.0
!pip install pyflux==0.4.15
!pip install pyglet==1.3.2
!pip install pygments==2.2.0
!pip install pykalman==0.9.5
!pip install pykoko==0.1.8
!pip install pyldavis==2.1.2
!pip install pylint==1.8.4
!pip install pymagnitude==0.1.120
!pip install pymc3==3.6
!pip install pymongo==3.8.0
!pip install pympler==0.7
!pip install pyocr==0.6
!pip install pyodbc==4.0.23
!pip install pyopengl==3.1.0
!pip install pyopenssl==18.0.0
!pip install pypandoc==1.4
!pip install pyparsing==2.2.0
!pip install pypdf==1.13
!pip install pyperclip==1.7.0
!pip install pyphen==0.9.5
!pip install pyprind==2.11.2
!pip install pyproj==2.1.3
!pip install pysal==2.0.0
!pip install pyshp==2.1.0
!pip install pysocks==1.6.8
!pip install pystan==2.19.0.0
!pip install pytagcloud==0.3.5
!pip install pytesseract==0.2.6
!pip install pytest-arraydiff==0.2
!pip install pytest-astropy==0.3.0
!pip install pytest-cov==2.6.1
!pip install pytest-doctestplus==0.1.3
!pip install pytest-mock==1.10.4
!pip install pytest-openfiles==0.3.0
!pip install pytest-remotedata==0.2.1
!pip install pytest==3.5.1
!pip install pytext-nlp==0.1.2
!pip install python-dateutil==2.6.0
!pip install python-editor==1.0.4
!pip install python-igraph==0.7.1.post7
!pip install python-levenshtein==0.12.0
!pip install python-louvain==0.13
!pip install python-utils==2.3.0
!pip install pytz==2018.4
!pip install pyupset==0.1.1.post7
!pip install pyviz-comms==0.7.2
!pip install pywavelets==0.5.2
!pip install pyyaml==3.12
!pip install pyzmq==17.0.0
!pip install qtawesome==0.4.4
!pip install qtconsole==4.3.1
!pip install qtpy==1.4.1
!pip install raccoon==2.1.5
!pip install randomgen==1.16.4
!pip install ray==0.6.6
!pip install redis==3.2.1
!pip install regex==2019.4.14
!pip install requests==2.21.0
!pip install resampy==0.2.1
!pip install retrying==1.3.3
!pip install revrand==0.6.5
!pip install rf-perm-feat-import==0.1
!pip install rgf-python==3.5.0
!pip install rope==0.10.7
!pip install rsa==4.0
!pip install ruamel-yaml==0.15.35
!pip install s2sphere==0.2.5
!pip install s3fs==0.2.1
!pip install s3transfer==0.2.0
!pip install sacred==0.7.4
!pip install scattertext==0.0.2.48
!pip install scikit-image==0.15.0
!pip install scikit-learn==0.20.3
!pip install scikit-multilearn==0.2.0
!pip install scikit-optimize==0.5.2
!pip install scikit-plot==0.3.7
!pip install scikit-surprise==1.0.6
!pip install scipy==1.1.0
!pip install scs==2.1.0
!pip install seaborn==0.9.0
!pip install send2trash==1.5.0
!pip install sentencepiece==0.1.82
!pip install setuptools-git==1.2
!pip install setuptools==39.1.0
!pip install shap==0.28.5
!pip install shapely==1.6.4.post2
!pip install simplegeneric==0.8.1
!pip install simpleitk==1.2.0
!pip install singledispatch==3.4.0.3
!pip install six==1.12.0
!pip install sklearn-contrib-lightning==0.5.0
!pip install sklearn-contrib-py-earth==0.1.0
!pip install sklearn-pandas==1.8.0
!pip install sklearn==0.0
!pip install smart-open==1.8.2
!pip install smhasher==0.150.1
!pip install snowballstemmer==1.2.1
!pip install sortedcollections==0.6.1
!pip install sortedcontainers==1.5.10
!pip install spacy==2.1.3
!pip install spectral==0.19
!pip install speedml==0.9.3
!pip install sphinx-rtd-theme==0.2.4
!pip install sphinx==1.7.4
!pip install sphinxcontrib-websupport==1.0.1
!pip install spyder==3.2.8
!pip install sqlalchemy==1.2.7
!pip install squarify==0.4.2
!pip install srsly==0.0.5
!pip install statsmodels==0.9.0
!pip install stemming==1.0.1
!pip install stevedore==1.30.1
!pip install stop-words==2018.7.23
!pip install stopit==1.1.2
!pip install svgwrite==1.2.1
!pip install sympy==1.1.1
!pip install tables==3.5.1
!pip install tabulate==0.8.3
!pip install tblib==1.3.2
!pip install tensorboard==1.13.1
!pip install tensorboardx==1.6
!pip install tensorflow-estimator==1.13.0
!pip install tensorflow-hub==0.4.0
!pip install tensorflow-probability==0.6.0
!pip install tensorflow==1.13.1
!pip install tensorforce==0.4.3
!pip install tensorpack==0.9.4
!pip install termcolor==1.1.0
!pip install terminado==0.8.1
!pip install terminalplot==0.2.6
!pip install testpath==0.3.1
!pip install textacy==0.6.2
!pip install textblob==0.15.3
!pip install tflearn==0.3.2
!pip install theano==1.0.4+10.g9feed7868
!pip install thinc==7.0.4
!pip install tifffile==2019.3.18
!pip install tinycss2==1.0.2
!pip install toolz==0.9.0
!pip install torch==1.0.1.post2
!pip install torchaudio==0.2
!pip install torchtext==0.3.1
!pip install torchvision==0.2.2
!pip install tornado==5.0.2
!pip install tpot==0.10.1
!pip install tqdm==4.31.1
!pip install trackml==0.1.12
!pip install traitlets==4.3.2
!pip install trueskill==0.4.5
!pip install tsfresh==0.11.2
!pip install typing-extensions==3.7.2
!pip install typing==3.6.4
!pip install tzlocal==1.5.1
!pip install umap-learn==0.3.8
!pip install unicodecsv==0.14.1
!pip install unidecode==1.0.23
!pip install update-checker==0.16
!pip install uritemplate==3.0.0
!pip install urllib3==1.22
!pip install urwid==2.0.1
!pip install vecstack==0.3.0
!pip install vega3==0.13.0
!pip install vida==0.3
!pip install visvis==1.11.2
!pip install vowpalwabbit==8.5.0
!pip install vtk==8.1.2
!pip install wand==0.5.3
!pip install wasabi==0.2.1
!pip install wavio==0.0.4
!pip install wcwidth==0.1.7
!pip install webencodings==0.5.1
!pip install websocket-client==0.56.0
!pip install werkzeug==0.14.1
!pip install wfdb==2.2.1
!pip install wheel==0.31.1
!pip install widgetsnbextension==3.2.1
!pip install wordbatch==1.3.8
!pip install wordcloud==1.5.0
!pip install wordsegment==1.3.1
!pip install wrapt==1.10.11
!pip install xarray==0.12.1
!pip install xgboost==0.82
!pip install xlrd==1.1.0
!pip install xlsxwriter==1.0.4
!pip install xlwt==1.3.0
!pip install xvfbwrapper==0.2.9
!pip install xxhash==1.3.0
!pip install yellowbrick==0.9.1
!pip install zict==0.1.3

import streamlit as st
import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.svm import LinearSVC
import nltk
from nltk.tokenize import word_tokenize
from nltk.tag import pos_tag
from nltk.corpus import stopwords

# Download NLTK resources if not already downloaded
nltk.download('punkt')
nltk.download('averaged_perceptron_tagger')
nltk.download('stopwords')

# Load the data
@st.cache  # Cache the data for faster loading
def load_data():
    return pd.read_csv('row2.csv')

df = load_data()

# Sidebar for user input
st.sidebar.header('Enter Your Complaint')
user_input = st.sidebar.text_input("Please enter your complaint:")

if user_input:
    # Load the model
    @st.cache  # Cache the model for faster loading
    def load_model():
        # Prepare the data
        df2 = df[['Product', 'Consumer complaint narrative']].copy()
        df2 = df2[pd.notnull(df2['Consumer complaint narrative'])]

        # Load TF-IDF Vectorizer
        tfidf = TfidfVectorizer(sublinear_tf=True, min_df=5, ngram_range=(1, 2), stop_words='english')
        features = tfidf.fit_transform(df2['Consumer complaint narrative']).toarray()

        # Load the classifier
        model = LinearSVC()
        model.fit(features, df2['Product'])

        return model, tfidf

    model, tfidf = load_model()

    # Get the top predicted classes
    def predict_class(user_input, model, tfidf):
        features = tfidf.transform([user_input])
        prediction = model.predict(features)
        return prediction[0]

    prediction = predict_class(user_input, model, tfidf)

    # Filter DataFrame to get documents corresponding to the predicted class
    filtered_df = df[df['Product'] == prediction]

    # Function to extract nouns from text
    def extract_nouns(text):
        words = word_tokenize(text)
        stop_words = set(stopwords.words('english'))
        words = [word for word in words if word.lower() not in stop_words]
        tagged = pos_tag(words)
        nouns = [word for word, tag in tagged if tag in ('NN', 'NNS', 'NNP', 'NNPS')]
        return nouns

    # Apply the function to each document and prepare a list of unique nouns
    list_of_nouns = [noun for text in filtered_df['Consumer complaint narrative'] for noun in extract_nouns(text)]
    unique_nouns = list(set(list_of_nouns))

    st.write(f"Predicted Product: {prediction}")
    st.write("Keywords:")
    st.write(unique_nouns)

    # Generate a question based on the complaint and keywords
    st.write("Generated Question:")
    # Your code for generating a question goes here

# Run the Streamlit app
if __name__ == '__main__':
    st.title('Complaint Classifier and Question Generator')
    st.write("Welcome to the Complaint Classifier and Question Generator app!")
